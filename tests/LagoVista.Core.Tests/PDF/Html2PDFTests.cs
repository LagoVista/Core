// --- BEGIN CODE INDEX META (do not edit) ---
// ContentHash: f7df7defec10cfe36bdf83fa7fc2fa7f9746ac91281add5dadba4509fc060337
// IndexVersion: 0
// --- END CODE INDEX META ---
using LagoVista.PDFServices;
using Microsoft.VisualStudio.TestPlatform.PlatformAbstractions.Interfaces;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using PdfSharpCore.Fonts;
using Svg;
using System;
using System.Collections.Generic;
using System.Drawing.Imaging;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Xml;
using TheArtOfDev.HtmlRenderer.Core;

namespace LagoVista.Core.Tests.PDF
{
    [TestClass]
    public class Html2PDFTests
    {
        [TestMethod]
        public void ConvertToHtml()
        {
            GlobalFontSettings.FontResolver = new FontResolver();

            var sigSvg = @"<svg xmlns=""http://www.w3.org/2000/svg"" xmlns:xlink=""http://www.w3.org/1999/xlink"" viewBox=""0 0 334 150"" width=""334"" height=""150""><path d=""M 22.000,23.406 C 22.253,25.977 22.500,25.906 23.000,28.406"" stroke-width=""5.512"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 23.000,28.406 C 25.119,32.294 24.253,32.477 26.000,36.406"" stroke-width=""4.076"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 26.000,36.406 C 25.548,39.470 26.619,39.294 26.000,42.406"" stroke-width=""4.517"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 26.000,42.406 C 27.118,45.878 26.548,45.970 28.000,49.406"" stroke-width=""4.768"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 28.000,49.406 C 28.067,52.074 28.618,51.878 29.000,54.406"" stroke-width=""5.120"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 29.000,54.406 C 31.261,56.696 30.067,57.074 32.000,59.406"" stroke-width=""5.305"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 32.000,59.406 C 31.752,62.427 32.761,62.196 32.000,65.406"" stroke-width=""4.911"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 32.000,65.406 C 32.538,68.400 32.252,68.427 33.000,71.406"" stroke-width=""4.998"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 33.000,71.406 C 33.749,74.889 33.538,74.900 34.000,78.406"" stroke-width=""5.172"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 34.000,78.406 C 34.000,81.906 34.249,81.889 34.000,85.406"" stroke-width=""4.788"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 34.000,85.406 C 34.000,88.906 34.000,88.906 34.000,92.406"" stroke-width=""4.666"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 34.000,92.406 C 34.000,95.406 34.000,95.406 34.000,98.406"" stroke-width=""4.980"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 34.000,98.406 C 34.581,101.501 34.000,101.406 34.000,104.406"" stroke-width=""4.824"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 34.000,104.406 C 31.919,108.812 33.081,109.001 31.000,113.406"" stroke-width=""4.496"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 31.000,113.406 C 31.213,116.420 30.419,116.312 31.000,119.406"" stroke-width=""4.692"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 31.000,119.406 C 30.533,123.411 30.713,123.420 30.000,127.406"" stroke-width=""4.589"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 30.000,127.406 C 29.270,130.890 29.533,130.911 29.000,134.406"" stroke-width=""4.652"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 83.000,32.406 C 85.643,37.904 84.000,37.406 85.000,42.406"" stroke-width=""5.232"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 85.000,42.406 C 83.072,44.482 84.643,44.904 81.000,46.406"" stroke-width=""4.480"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 81.000,46.406 C 75.589,50.530 76.072,50.982 71.000,55.406"" stroke-width=""4.130"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 71.000,55.406 C 68.088,59.476 67.589,59.030 65.000,63.406"" stroke-width=""3.700"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 65.000,63.406 C 62.748,66.659 62.588,66.476 60.000,69.406"" stroke-width=""4.256"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 60.000,69.406 C 57.500,71.406 57.748,71.659 55.000,73.406"" stroke-width=""4.579"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 55.000,73.406 C 52.094,75.051 52.500,75.406 50.000,77.406"" stroke-width=""4.171"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 50.000,77.406 C 48.710,80.055 48.094,79.551 47.000,82.406"" stroke-width=""5.019"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 47.000,82.406 C 41.724,86.196 44.710,85.555 42.000,88.406"" stroke-width=""5.303"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 42.000,88.406 C 44.915,89.932 42.224,90.196 48.000,90.406"" stroke-width=""5.402"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 48.000,90.406 C 51.500,90.406 51.415,90.932 55.000,90.406"" stroke-width=""4.325"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 55.000,90.406 C 59.000,90.406 59.000,90.406 63.000,90.406"" stroke-width=""4.014"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 63.000,90.406 C 67.000,90.406 67.000,90.406 71.000,90.406"" stroke-width=""3.880"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 71.000,90.406 C 74.016,90.177 74.000,90.406 77.000,90.406"" stroke-width=""4.768"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 77.000,90.406 C 80.944,90.017 80.516,90.677 84.000,91.406"" stroke-width=""4.887"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 84.000,91.406 C 86.584,93.046 86.444,92.517 88.000,95.406"" stroke-width=""4.401"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 88.000,95.406 C 89.170,98.361 89.584,98.046 90.000,101.406"" stroke-width=""4.649"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 90.000,101.406 C 90.067,104.074 90.670,103.861 91.000,106.406"" stroke-width=""4.419"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 91.000,106.406 C 93.261,108.696 92.067,109.074 94.000,111.406"" stroke-width=""4.255"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 94.000,111.406 C 93.730,114.433 94.761,114.196 94.000,117.406"" stroke-width=""4.139"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 94.000,117.406 C 94.031,122.794 94.230,119.933 95.000,122.406"" stroke-width=""4.269"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 113.000,50.406 C 117.778,57.084 117.000,57.406 121.000,64.406"" stroke-width=""5.106"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 121.000,64.406 C 122.783,69.841 123.278,69.584 124.000,75.406"" stroke-width=""3.678"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 124.000,75.406 C 125.904,85.926 126.283,85.841 128.000,96.406"" stroke-width=""3.518"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 128.000,96.406 C 128.768,100.971 128.904,100.926 130.000,105.406"" stroke-width=""3.553"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 130.000,105.406 C 132.186,109.795 131.268,109.971 133.000,114.406"" stroke-width=""3.538"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 133.000,114.406 C 132.716,118.430 133.686,118.295 133.000,122.406"" stroke-width=""3.734"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 133.000,122.406 C 133.456,125.414 133.216,125.430 134.000,128.406"" stroke-width=""4.011"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 134.000,128.406 C 135.263,134.588 134.456,130.914 135.000,133.406"" stroke-width=""4.577"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 135.000,133.406 C 134.499,125.965 134.263,130.088 132.000,119.406"" stroke-width=""4.847"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 132.000,119.406 C 128.462,116.304 130.499,115.465 127.000,112.406"" stroke-width=""4.011"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 127.000,112.406 C 127.086,107.752 125.462,108.304 126.000,103.406"" stroke-width=""3.708"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 126.000,103.406 C 125.074,99.518 125.086,99.752 123.000,96.406"" stroke-width=""3.876"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 123.000,96.406 C 119.987,94.245 121.074,93.518 118.000,91.406"" stroke-width=""3.839"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 118.000,91.406 C 116.435,89.015 116.487,89.245 116.000,86.406"" stroke-width=""4.090"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 116.000,86.406 C 116.000,82.906 115.435,83.015 116.000,79.406"" stroke-width=""3.965"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 116.000,79.406 C 115.720,74.886 116.000,74.906 116.000,70.406"" stroke-width=""4.253"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 116.000,70.406 C 115.356,66.147 116.220,66.886 117.000,63.406"" stroke-width=""4.000"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 117.000,63.406 C 119.289,61.146 118.356,61.147 122.000,60.406"" stroke-width=""4.502"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 122.000,60.406 C 125.000,60.406 124.789,59.646 128.000,60.406"" stroke-width=""4.708"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 128.000,60.406 C 135.492,58.011 134.500,60.406 141.000,60.406"" stroke-width=""3.597"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 141.000,60.406 C 146.000,65.406 146.992,63.011 151.000,70.406"" stroke-width=""3.211"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 151.000,70.406 C 157.503,75.994 157.000,76.406 163.000,82.406"" stroke-width=""2.923"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 163.000,82.406 C 165.533,87.289 166.503,86.494 169.000,91.406"" stroke-width=""3.265"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 169.000,91.406 C 174.775,95.881 173.533,96.789 179.000,101.406"" stroke-width=""3.771"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 179.000,101.406 C 181.268,104.749 181.275,104.381 182.000,108.406"" stroke-width=""4.469"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 182.000,108.406 C 182.000,112.406 182.768,112.249 182.000,116.406"" stroke-width=""4.510"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 182.000,116.406 C 183.881,122.374 182.000,121.406 182.000,126.406"" stroke-width=""3.785"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 182.000,126.406 C 178.468,128.863 180.381,129.874 175.000,131.406"" stroke-width=""3.695"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 175.000,131.406 C 171.474,135.827 170.968,134.363 167.000,137.406"" stroke-width=""4.329"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 167.000,137.406 C 162.423,137.959 162.974,138.827 158.000,137.406"" stroke-width=""4.392"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 158.000,137.406 C 154.095,137.094 154.423,136.959 151.000,135.406"" stroke-width=""4.750"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 187.000,62.406 C 189.574,65.664 189.000,65.906 191.000,69.406"" stroke-width=""5.387"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 191.000,69.406 C 193.861,76.286 193.574,76.164 195.000,83.406"" stroke-width=""3.409"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 195.000,83.406 C 194.472,88.946 195.861,88.786 195.000,94.406"" stroke-width=""3.466"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 195.000,94.406 C 196.886,104.377 195.972,104.446 198.000,114.406"" stroke-width=""2.785"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 198.000,114.406 C 197.795,117.916 198.386,117.877 198.000,121.406"" stroke-width=""3.489"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 198.000,121.406 C 197.544,126.748 198.295,126.416 199.000,131.406"" stroke-width=""3.465"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 199.000,131.406 C 200.649,137.949 200.044,134.748 203.000,137.406"" stroke-width=""3.744"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 203.000,137.406 C 208.135,133.408 207.149,136.449 212.000,128.406"" stroke-width=""4.601"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 212.000,128.406 C 216.118,121.975 216.635,122.408 220.000,115.406"" stroke-width=""3.318"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 220.000,115.406 C 223.114,111.121 222.618,110.975 225.000,106.406"" stroke-width=""3.496"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 225.000,106.406 C 224.298,100.406 226.114,103.621 226.000,100.406"" stroke-width=""3.925"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 226.000,100.406 C 231.430,102.435 228.798,100.406 234.000,106.406"" stroke-width=""4.612"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 234.000,106.406 C 235.111,112.055 236.930,110.935 237.000,117.406"" stroke-width=""3.664"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 237.000,117.406 C 238.864,120.281 238.111,120.555 240.000,123.406"" stroke-width=""3.868"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 240.000,123.406 C 240.147,129.088 240.864,125.781 241.000,128.406"" stroke-width=""4.543"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 241.000,128.406 C 243.378,124.041 242.647,127.088 245.000,119.406"" stroke-width=""4.835"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 245.000,119.406 C 246.884,113.986 246.878,114.041 248.000,108.406"" stroke-width=""3.634"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 248.000,108.406 C 249.546,101.445 249.384,101.486 250.000,94.406"" stroke-width=""3.220"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 250.000,94.406 C 250.000,85.906 250.546,85.945 250.000,77.406"" stroke-width=""2.924"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 250.000,77.406 C 250.000,69.406 250.000,69.406 250.000,61.406"" stroke-width=""2.905"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 250.000,61.406 C 250.356,53.877 250.000,53.906 250.000,46.406"" stroke-width=""2.904"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 250.000,46.406 C 249.202,39.801 249.856,43.377 249.000,40.406"" stroke-width=""4.276"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 9.000,7.406 C 12.079,6.919 12.000,7.406 15.000,7.406"" stroke-width=""5.467"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 15.000,7.406 C 18.051,8.272 18.079,7.919 21.000,9.406"" stroke-width=""4.955"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 21.000,9.406 C 24.380,11.243 24.551,10.772 28.000,12.406"" stroke-width=""4.679"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 28.000,12.406 C 38.351,16.470 38.380,15.743 49.000,18.406"" stroke-width=""4.135"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 49.000,18.406 C 55.000,18.406 54.851,19.470 61.000,18.406"" stroke-width=""3.444"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 61.000,18.406 C 68.000,18.406 68.000,18.406 75.000,18.406"" stroke-width=""3.184"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 75.000,18.406 C 84.031,18.033 84.000,18.406 93.000,18.406"" stroke-width=""2.854"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 93.000,18.406 C 95.973,19.228 96.031,18.533 99.000,19.406"" stroke-width=""3.612"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 99.000,19.406 C 104.584,18.805 104.473,19.728 110.000,19.406"" stroke-width=""3.412"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 110.000,19.406 C 113.471,20.524 113.584,19.805 117.000,21.406"" stroke-width=""3.718"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 117.000,21.406 C 119.529,21.788 119.471,22.024 122.000,22.406"" stroke-width=""4.124"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 122.000,22.406 C 125.471,23.524 125.529,23.288 129.000,24.406"" stroke-width=""3.882"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 129.000,24.406 C 131.486,24.987 131.471,25.024 134.000,25.406"" stroke-width=""4.143"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 134.000,25.406 C 137.481,26.172 137.486,25.987 141.000,26.406"" stroke-width=""3.971"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 141.000,26.406 C 145.000,26.406 144.981,26.672 149.000,26.406"" stroke-width=""4.361"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 149.000,26.406 C 152.547,25.975 152.500,26.406 156.000,26.406"" stroke-width=""4.038"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 156.000,26.406 C 160.453,27.838 160.547,26.975 165.000,28.406"" stroke-width=""3.697"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 165.000,28.406 C 168.529,28.117 168.453,28.838 172.000,28.406"" stroke-width=""4.295"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 172.000,28.406 C 174.473,29.177 174.529,28.617 177.000,29.406"" stroke-width=""4.275"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 177.000,29.406 C 180.000,29.406 179.973,29.677 183.000,29.406"" stroke-width=""4.779"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 183.000,29.406 C 186.500,29.406 186.500,29.406 190.000,29.406"" stroke-width=""4.138"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 190.000,29.406 C 193.000,29.406 193.000,29.406 196.000,29.406"" stroke-width=""4.152"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 196.000,29.406 C 200.000,29.406 200.000,29.406 204.000,29.406"" stroke-width=""3.917"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 204.000,29.406 C 209.500,29.406 209.500,29.406 215.000,29.406"" stroke-width=""4.124"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 215.000,29.406 C 220.000,29.406 220.000,29.406 225.000,29.406"" stroke-width=""4.257"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 225.000,29.406 C 228.000,29.406 228.000,29.406 231.000,29.406"" stroke-width=""4.187"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 231.000,29.406 C 234.509,29.600 234.500,29.406 238.000,29.406"" stroke-width=""4.525"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 238.000,29.406 C 243.622,29.415 243.509,29.100 249.000,28.406"" stroke-width=""4.303"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 249.000,28.406 C 251.390,26.966 251.622,27.915 254.000,26.406"" stroke-width=""4.236"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 254.000,26.406 C 258.825,26.798 258.390,25.466 263.000,25.406"" stroke-width=""4.339"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 263.000,25.406 C 265.804,23.004 266.325,24.298 269.000,21.406"" stroke-width=""4.512"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 269.000,21.406 C 271.915,19.881 271.804,20.004 275.000,19.406"" stroke-width=""4.846"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 275.000,19.406 C 278.522,19.674 278.415,18.881 282.000,19.406"" stroke-width=""4.700"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 282.000,19.406 C 285.008,18.950 285.022,19.174 288.000,18.406"" stroke-width=""4.719"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 288.000,18.406 C 290.500,17.906 290.508,17.950 293.000,17.406"" stroke-width=""5.132"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 293.000,17.406 C 295.473,16.636 295.500,16.906 298.000,16.406"" stroke-width=""5.302"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 298.000,16.406 C 301.000,16.406 300.973,16.136 304.000,16.406"" stroke-width=""5.190"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 304.000,16.406 C 307.101,15.879 307.000,16.406 310.000,16.406"" stroke-width=""5.395"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 310.000,16.406 C 312.406,17.758 312.601,16.879 315.000,18.406"" stroke-width=""5.162"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 315.000,18.406 C 320.000,17.406 318.406,19.258 322.000,19.406"" stroke-width=""5.159"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 322.000,19.406 C 322.730,22.890 324.000,21.406 323.000,26.406"" stroke-width=""5.406"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 323.000,26.406 C 323.000,29.406 323.230,29.390 323.000,32.406"" stroke-width=""4.968"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 323.000,32.406 C 323.000,35.906 323.000,35.906 323.000,39.406"" stroke-width=""4.898"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 323.000,39.406 C 323.000,43.406 323.000,43.406 323.000,47.406"" stroke-width=""4.844"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 323.000,47.406 C 323.000,50.406 323.000,50.406 323.000,53.406"" stroke-width=""5.151"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 323.000,53.406 C 323.000,56.406 323.000,56.406 323.000,59.406"" stroke-width=""4.854"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 323.000,59.406 C 323.637,63.010 323.000,62.906 323.000,66.406"" stroke-width=""4.703"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 323.000,66.406 C 320.814,70.795 322.137,71.010 320.000,75.406"" stroke-width=""4.505"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 320.000,75.406 C 320.000,79.406 319.314,79.295 320.000,83.406"" stroke-width=""4.502"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 320.000,83.406 C 320.000,86.406 320.000,86.406 320.000,89.406"" stroke-width=""4.847"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 320.000,89.406 C 320.000,92.906 320.000,92.906 320.000,96.406"" stroke-width=""4.718"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 320.000,96.406 C 320.000,100.406 320.000,100.406 320.000,104.406"" stroke-width=""4.636"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 320.000,104.406 C 320.000,108.406 320.000,108.406 320.000,112.406"" stroke-width=""4.578"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 320.000,112.406 C 320.289,115.935 320.000,115.906 320.000,119.406"" stroke-width=""4.936"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 320.000,119.406 C 320.459,122.704 319.789,121.935 319.000,124.406"" stroke-width=""5.363"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 319.000,124.406 C 316.041,124.774 317.459,126.204 314.000,126.406"" stroke-width=""5.160"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 314.000,126.406 C 311.959,129.985 311.041,128.774 309.000,132.406"" stroke-width=""5.349"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 309.000,132.406 C 306.159,134.353 306.459,134.485 303.000,135.406"" stroke-width=""4.858"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 303.000,135.406 C 298.471,136.289 298.659,136.853 294.000,137.406"" stroke-width=""4.504"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 294.000,137.406 C 288.541,139.076 288.471,138.789 283.000,140.406"" stroke-width=""3.575"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 283.000,140.406 C 275.961,141.749 276.041,142.076 269.000,143.406"" stroke-width=""3.812"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 269.000,143.406 C 265.563,144.858 265.461,144.249 262.000,145.406"" stroke-width=""4.352"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 262.000,145.406 C 259.000,145.406 259.063,145.858 256.000,145.406"" stroke-width=""5.059"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 256.000,145.406 C 252.987,145.620 253.000,145.406 250.000,145.406"" stroke-width=""4.846"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 250.000,145.406 C 246.013,144.693 245.987,145.120 242.000,144.406"" stroke-width=""5.191"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 242.000,144.406 C 238.899,144.933 239.013,144.193 236.000,144.406"" stroke-width=""4.881"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 236.000,144.406 C 233.568,143.177 233.399,143.933 231.000,142.406"" stroke-width=""5.208"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 231.000,142.406 C 228.406,142.208 228.568,141.677 226.000,141.406"" stroke-width=""5.121"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 226.000,141.406 C 222.287,140.285 222.406,140.208 219.000,138.406"" stroke-width=""4.723"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 219.000,138.406 C 215.829,134.879 215.287,136.285 212.000,133.406"" stroke-width=""4.885"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 212.000,133.406 C 208.979,133.655 209.329,132.379 206.000,133.406"" stroke-width=""5.164"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 206.000,133.406 C 203.029,132.558 202.979,133.155 200.000,132.406"" stroke-width=""5.059"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 200.000,132.406 C 193.000,132.406 193.029,132.058 186.000,132.406"" stroke-width=""4.228"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 186.000,132.406 C 183.000,132.406 183.000,132.406 180.000,132.406"" stroke-width=""4.131"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 180.000,132.406 C 176.500,132.406 176.500,132.406 173.000,132.406"" stroke-width=""4.475"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 173.000,132.406 C 170.000,132.406 170.000,132.406 167.000,132.406"" stroke-width=""4.655"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 167.000,132.406 C 163.500,132.406 163.500,132.406 160.000,132.406"" stroke-width=""4.627"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 160.000,132.406 C 156.000,132.406 156.000,132.406 152.000,132.406"" stroke-width=""4.035"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 152.000,132.406 C 148.500,132.406 148.500,132.406 145.000,132.406"" stroke-width=""3.999"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 145.000,132.406 C 141.500,132.406 141.500,132.406 138.000,132.406"" stroke-width=""4.035"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 138.000,132.406 C 132.000,132.406 132.000,132.406 126.000,132.406"" stroke-width=""4.074"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 126.000,132.406 C 122.000,132.406 122.000,132.406 118.000,132.406"" stroke-width=""4.603"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 118.000,132.406 C 111.500,132.406 111.500,132.406 105.000,132.406"" stroke-width=""4.518"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 105.000,132.406 C 100.976,132.690 101.000,132.406 97.000,132.406"" stroke-width=""4.933"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 97.000,132.406 C 94.022,131.639 93.976,132.190 91.000,131.406"" stroke-width=""4.300"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 91.000,131.406 C 87.500,131.406 87.522,131.139 84.000,131.406"" stroke-width=""4.533"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 84.000,131.406 C 80.500,131.406 80.500,131.406 77.000,131.406"" stroke-width=""4.880"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 77.000,131.406 C 74.000,131.406 74.000,131.406 71.000,131.406"" stroke-width=""4.979"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 71.000,131.406 C 67.500,131.406 67.500,131.406 64.000,131.406"" stroke-width=""5.220"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 64.000,131.406 C 61.000,131.406 61.000,131.406 58.000,131.406"" stroke-width=""5.072"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 58.000,131.406 C 54.899,130.879 55.000,131.406 52.000,131.406"" stroke-width=""4.880"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 52.000,131.406 C 49.583,132.702 49.399,131.879 47.000,133.406"" stroke-width=""5.132"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 47.000,133.406 C 44.022,134.174 44.083,134.202 41.000,134.406"" stroke-width=""4.841"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 41.000,134.406 C 37.500,134.406 37.522,134.674 34.000,134.406"" stroke-width=""4.906"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 34.000,134.406 C 30.500,134.406 30.500,134.406 27.000,134.406"" stroke-width=""4.926"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 27.000,134.406 C 23.042,135.512 23.500,134.406 20.000,134.406"" stroke-width=""5.133"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 20.000,134.406 C 16.723,132.935 17.542,133.512 16.000,130.406"" stroke-width=""5.396"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 16.000,130.406 C 16.000,125.406 14.723,125.935 16.000,120.406"" stroke-width=""5.127"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 16.000,120.406 C 16.000,116.906 16.000,116.906 16.000,113.406"" stroke-width=""4.932"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 16.000,113.406 C 16.000,109.906 16.000,109.906 16.000,106.406"" stroke-width=""4.916"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 16.000,106.406 C 16.000,102.906 16.000,102.906 16.000,99.406"" stroke-width=""5.175"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 16.000,99.406 C 16.000,96.406 16.000,96.406 16.000,93.406"" stroke-width=""5.075"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 16.000,93.406 C 16.000,89.906 16.000,89.906 16.000,86.406"" stroke-width=""4.763"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 16.000,86.406 C 16.000,82.906 16.000,82.906 16.000,79.406"" stroke-width=""4.677"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 16.000,79.406 C 16.280,74.886 16.000,74.906 16.000,70.406"" stroke-width=""4.494"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 16.000,70.406 C 15.500,66.906 15.780,66.886 15.000,63.406"" stroke-width=""4.622"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 15.000,63.406 C 15.096,59.695 14.500,59.906 14.000,56.406"" stroke-width=""4.870"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 14.000,56.406 C 12.301,54.008 13.096,53.695 11.000,51.406"" stroke-width=""5.203"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 11.000,51.406 C 9.366,47.957 9.301,48.008 8.000,44.406"" stroke-width=""4.992"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 8.000,44.406 C 6.830,41.451 6.866,41.457 6.000,38.406"" stroke-width=""4.815"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 6.000,38.406 C 5.670,35.861 5.330,35.951 5.000,33.406"" stroke-width=""4.915"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 5.000,33.406 C 3.513,30.485 4.170,30.361 3.000,27.406"" stroke-width=""5.195"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 3.000,27.406 C 3.000,24.406 2.513,24.485 3.000,21.406"" stroke-width=""5.073"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 3.000,21.406 C 2.730,18.379 3.000,18.406 3.000,15.406"" stroke-width=""5.310"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 3.000,15.406 C 2.541,12.108 3.230,12.879 4.000,10.406"" stroke-width=""5.460"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 324.000,55.406 C 326.277,51.160 326.000,53.406 328.000,51.406"" stroke-width=""5.369"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 328.000,51.406 C 330.318,53.680 329.777,51.660 331.000,56.406"" stroke-width=""5.469"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 331.000,56.406 C 331.000,59.906 331.818,59.680 331.000,63.406"" stroke-width=""4.862"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 331.000,63.406 C 331.000,66.406 331.000,66.406 331.000,69.406"" stroke-width=""4.295"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 331.000,69.406 C 331.000,72.406 331.000,72.406 331.000,75.406"" stroke-width=""5.044"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 331.000,75.406 C 331.000,78.406 331.000,78.406 331.000,81.406"" stroke-width=""5.303"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 331.000,81.406 C 331.249,84.924 331.000,84.906 331.000,88.406"" stroke-width=""4.821"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 331.000,88.406 C 331.500,92.406 330.749,91.924 330.000,95.406"" stroke-width=""5.167"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 330.000,95.406 C 327.500,97.906 328.500,98.406 325.000,100.406"" stroke-width=""5.414"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path><path d=""M 325.000,100.406 C 322.723,102.190 323.000,102.406 321.000,104.406"" stroke-width=""5.338"" stroke=""black"" fill=""none"" stroke-linecap=""round""></path></svg>";


            var dox = new XmlDocument();
            dox.LoadXml(sigSvg);

            using (var imageStream = new MemoryStream())
            { 

                var doc = SvgDocument.Open(dox);
                var image = doc.Draw();
                image.Save(imageStream, ImageFormat.Png);
                imageStream.Seek(0, SeekOrigin.Begin);
                var buffer = imageStream.GetBuffer();
                var b64 = Convert.ToBase64String(buffer);

                using (var ms = new MemoryStream())
                {
                    var html = System.IO.File.ReadAllText("ServicesAgreement.htm");
                    html = $" <img width=\"120\" height=\"30\" src=\"data:image/png;base64, {b64} /> {html}";
                    var pdf = TheArtOfDev.HtmlRenderer.PdfSharp.PdfGenerator.GeneratePdf(html, PdfSharpCore.PageSize.A4);
                    pdf.Save(ms);
                    ms.Seek(0, SeekOrigin.Begin);
                    using (var fileStream = new FileStream(@"X:\Out.pdf", FileMode.Create, FileAccess.Write))
                    {
                        ms.CopyTo(fileStream);
                    };
                }
            }
        }
       
    }
}
